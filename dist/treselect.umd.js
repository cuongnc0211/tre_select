(function(i,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(i=typeof globalThis<"u"?globalThis:i||self,l(i.TreSelect={}))})(this,function(i){"use strict";class l{constructor(e,t={}){this.selectEl=e,this.options=t,this.wrapper=null,this.dropdown=null,this.input=null,this.selected=new Set,this.init()}init(){this.selectEl.style.display="none",this.loadFallbackCSSIfTailwindMissing(),this.buildUI(),this.bindEvents()}applyInputClasses(e,t,s=""){e.classList.length>0?e.classList.forEach(n=>t.classList.add(n)):t.classList.add(s)}buildUI(){this.wrapper=document.createElement("div"),this.wrapper.className="treselect relative w-full";const e=document.createElement("div");e.className="flex flex-wrap items-center border rounded p-2 gap-2",this.input=document.createElement("input"),this.input.type="text",this.input.className="flex-1 outline-none",this.applyInputClasses(this.selectEl,this.input),e.appendChild(this.input),this.dropdown=document.createElement("ul"),this.dropdown.className="absolute z-10 w-full bg-white border mt-1 rounded shadow max-h-60 overflow-y-auto hidden",Array.from(this.selectEl.options).forEach(t=>{const s=document.createElement("li");s.textContent=t.textContent,s.dataset.value=t.value,s.className="px-3 py-2 hover:bg-gray-100 cursor-pointer",this.dropdown.appendChild(s)}),this.wrapper.appendChild(e),this.wrapper.appendChild(this.dropdown),this.selectEl.parentNode.insertBefore(this.wrapper,this.selectEl.nextSibling)}bindEvents(){this.input.addEventListener("focus",()=>{this.dropdown.classList.remove("hidden")}),this.input.addEventListener("blur",()=>{setTimeout(()=>this.dropdown.classList.add("hidden"),100)}),this.input.addEventListener("input",()=>{const e=this.input.value.toLowerCase();Array.from(this.dropdown.children).forEach(t=>{const s=t.dataset.value,n=t.textContent.toLowerCase(),d=this.selected.has(s),o=(e===""||n.includes(e))&&!d;t.classList.toggle("hidden",!o)})}),this.dropdown.addEventListener("click",e=>{if(e.target.tagName!=="LI")return;const t=e.target.dataset.value,s=e.target.textContent;this.selected.has(t)||(this.selected.add(t),this.selectEl.querySelector(`option[value="${t}"]`).selected=!0,this.addTag(s,t),this.input.value="",this.filterOptions())})}addTag(e,t){const s=document.createElement("span");s.className="bg-green-100 text-green-800 text-sm px-2 py-1 rounded flex items-center gap-1",s.textContent=e;const n=document.createElement("button");n.type="button",n.textContent="Ã—",n.className="text-red-500 hover:text-red-700 font-bold mx-1",n.addEventListener("click",()=>{s.remove(),this.selectEl.querySelector(`option[value="${t}"]`).selected=!1,this.selected.delete(t),this.filterOptions()}),s.appendChild(n),this.input.parentNode.insertBefore(s,this.input)}filterOptions(){const e=this.input.value.toLowerCase();Array.from(this.dropdown.children).forEach(t=>{const s=t.dataset.value,n=t.textContent.toLowerCase(),d=this.selected.has(s),o=(e===""||n.includes(e))&&!d;t.classList.toggle("hidden",!o)})}loadFallbackCSSIfTailwindMissing(){const e=document.createElement("div");e.className="hidden",document.body.appendChild(e);const s=window.getComputedStyle(e).display==="none";if(document.body.removeChild(e),!s){const n=document.createElement("link");n.rel="stylesheet",n.href="/public/treselect-fallback.css",document.head.appendChild(n)}}}i.TreSelect=l,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
